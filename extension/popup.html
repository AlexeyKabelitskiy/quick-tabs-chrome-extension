<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <link rel="stylesheet" href="assets/styles.css" type="text/css" media="all"/>
    <script type="text/javascript" src="js/jquery-1.3.2.min.js"></script>
    <script type="text/javascript" src="js/keynav.js"></script>
    <script type="text/javascript">
        function init() {

            // find the available tabs
            var tabs = chrome.extension.getBackgroundPage().tabs;

            // draw the current tabs
            $("#template").text("");
            $.each(tabs, function(i, tab) {
                $("#template").append($("<li></li>")
                        .attr({class:"withoutfocus tab " + tab.id})
                        .append($("<img></img>").attr({class:"tabimage", src:tab.favIconUrl, width:"16", height:"16", border:"0"}))
                        .append($("<span></span>").text(tab.title))
                        .click(function() {
                    chrome.tabs.update(tab.id, {selected:true});
                    window.close();
                }));
            });

            // initialize jQuery keyboard navigation
            $('ol li').keynav('withfocus','withoutfocus');

            // set the first li as the one with focus
            $('ol li:first').removeClass('withoutfocus').addClass('withfocus');

            // setup the search box
            $("#search").keyup(function (e) {
                var s = $("#search").val().toUpperCase();
                if(s.length > 0) {
                    $(".tab").filter(function () {return $(this).text().toUpperCase().indexOf(s) < 0}).fadeOut("fast");
                    $(".tab").filter(function () {return $(this).text().toUpperCase().indexOf(s) > 0}).fadeIn("fast");
                } else {
                    $(".tab").fadeIn("fast");
                }
            }).focus();
        }
    </script>
    <title>Quick Tabs</title>
</head>
<body onload="init()">
<div><input type="text" id="search"><img class="search" src="assets/search.png" alt="" width="16" height="16"></div>
<ol id="template">
    <li class="withoutfocus"><img class="tabimage" src="assets/icon-32.png" alt="image" height="16" width="16"><span>page title goes here</span></li>
    <li class="withoutfocus"><img class="tabimage" src="assets/icon-32.png" alt="image" height="16" width="16"><span>a very very very very very page title goes here</span></li>
</ol>
</body>
</html>